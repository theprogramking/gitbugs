"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[156],{156:(e,t,r)=>{r.d(t,{fetchGitHubIssues:()=>i});var s=r(9509);let o=e=>{let t=e.map(e=>e.name.toLowerCase());return t.some(e=>e.includes("bug")||e.includes("error")||e.includes("fix"))?"bug":t.some(e=>e.includes("feature")||e.includes("enhancement")||e.includes("request")||e.includes("improvement"))?"feature":"other"},a=()=>s.env.NEXT_PUBLIC_GITHUB_TOKEN,n=e=>new Promise(t=>setTimeout(t,e));async function i(){try{var e;let t=a();console.log("Server-side GitHub token available:",!!t);let r={Accept:"application/vnd.github.v3+json","User-Agent":"GitHub-Issues-Explorer/2.0.0"};t&&(r.Authorization="Bearer ".concat(t)),console.log("Server-side: Fetching trending repositories...");let s=await fetch("https://api.github.com/search/repositories?q=stars:>5000+language:javascript+language:typescript+language:python+language:java+language:go+language:rust&sort=stars&order=desc&per_page=100",{headers:r,cache:"no-store",signal:AbortSignal.timeout(1e4)});if(!s.ok){let e=await s.text();if(console.error("Server-side: Repository fetch error:",e),401===s.status)return{issues:[],error:"Authentication failed (".concat(s.status,"). Please check your GitHub token.")};if(403!==s.status)return{issues:[],error:"GitHub API error (".concat(s.status,"): ").concat(s.statusText)};{let e=s.headers.get("x-ratelimit-reset"),t=e?new Date(1e3*Number.parseInt(e)).toLocaleTimeString():"unknown";return{issues:[],error:"Rate limit exceeded (".concat(s.status,"). Resets at ").concat(t,". Please add a GitHub token for higher limits.")}}}let i=await s.json();if(console.log("Server-side: Found ".concat((null===(e=i.items)||void 0===e?void 0:e.length)||0," repositories")),!i.items||0===i.items.length)return{issues:[],error:"No repositories found"};let l=[],c=i.items.slice(0,50);for(let e=0;e<c.length;e+=10){let t=c.slice(e,e+10);console.log("Processing batch ".concat(Math.floor(e/10)+1,"/").concat(Math.ceil(c.length/10)));let s=t.map(async e=>{try{console.log("Server-side: Fetching issues from ".concat(e.full_name,"..."));let t=await fetch("https://api.github.com/repos/".concat(e.owner.login,"/").concat(e.name,"/issues?state=open&per_page=50&sort=created&direction=desc"),{headers:r,cache:"no-store",signal:AbortSignal.timeout(8e3)});if(!t.ok)return console.warn("Server-side: Failed to fetch issues for ".concat(e.full_name,": ").concat(t.status)),[];let s=(await t.json()).filter(e=>!e.pull_request).slice(0,50).map(t=>{var r;let s=(null===(r=t.labels)||void 0===r?void 0:r.map(e=>({name:e.name,color:e.color,description:e.description})))||[],a=o(s);return"bug"!==a||s.some(e=>e.name.toLowerCase().includes("bug"))||s.push({name:"bug",color:"d73a4a",description:"Something isn't working"}),"feature"!==a||s.some(e=>e.name.toLowerCase().includes("feature")||e.name.toLowerCase().includes("enhancement"))||s.push({name:"feature-request",color:"a2eeef",description:"New feature or request"}),{id:t.id,number:t.number,title:t.title,body:t.body||"",description:t.body?t.body.length>400?t.body.substring(0,400)+"...":t.body:"No description available",labels:s,user:{login:t.user.login,avatar_url:t.user.avatar_url,html_url:t.user.html_url},repositoryName:"".concat(e.owner.login,"/").concat(e.name),repositoryUrl:e.html_url,issueLink:t.html_url,createdDate:t.created_at,updatedDate:t.updated_at,comments:t.comments||0,state:t.state,issueType:a}});return console.log("Server-side: Added ".concat(s.length," issues from ").concat(e.full_name)),s}catch(t){return console.warn("Server-side: Failed to fetch issues for ".concat(e.full_name,":"),t.message),[]}}),a=await Promise.all(s);l.push(...a.flat()),e+10<c.length&&await n(1e3)}if(console.log("Server-side: Total issues fetched: ".concat(l.length)),0===l.length)return{issues:[],error:"No issues found in the repositories"};return{issues:l,error:null}}catch(t){if(console.error("Server-side: Error fetching issues:",t),"TimeoutError"===t.name)return{issues:[],error:"Request timed out. Please try again later."};let e="Failed to fetch issues. ";return{issues:[],error:e+=t.message||"Please check your internet connection and try again."}}}}}]);